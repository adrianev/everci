<apex:page renderAs="pdf" applyBodyTag="false" docType="html-5.0" standardstylesheets="false"
    showHeader="false" standardController="Case" extensions="PDF_Presupuesto">
<head>
    <style type="text/css" media="print">
        @page {
            margin-top:28mm;
            margin-left:10mm;
            margin-right:10mm;
            margin-bottom:19mm;
            @top-center {
                content: element(header);
            }
            @top-right {
                content: element(pages);
            }
            @bottom-left {
                content: element(footer);
            }
            @left-middle {
                content: element(vertext);
            }
        }
        @page:first {
            margin-top:22mm;
            margin-left:10mm;
            margin-right:10mm;
            margin-bottom:20mm;
        }
        body {
            font-family:Arial Unicode MS;
            font-size:10px;
            color:#4A4A4A;
        } 
        div.header {
            padding-top:2mm;
            padding-left:2mm;
            padding-right:2mm;
            height:20mm;
            z-index:-1;
            border:solid #E7342C 0px;
            position: running(header);
        }
        div.vertext {
            display: block;
            padding: 5px;
            position: running(vertext);
            font-size:0em;
        }
        div.footer {
            display: block;
            padding: 5px;
            position: running(footer);
            font-size:1.2em;            
        }
        div.summary {
            display: block;
            padding: 5px;
            position: running(summary);
            font-size:1.2em;
            border:0.5em solid;
            background-color:blue;         
        }
        .pagenumber:before {
            content: counter(page);
        }
        .pagecount:before {
            content: counter(pages);
        }
        .logo {
            left:0mm;
            z-index:-1;
            width:39mm;
            margin-top:0.4em;
        }
        .vertical-text {
            margin-left:3.5mm;
            z-index:-1;
            height:240mm; 
        }
        .presupuestosub {
            font-size:6mm;
            color:#E7342C;
            font-weight:bolder;
            left:140mm;
            margin-top:10mm;
            float:right;
        }
        .td-red-back {
            margin:0mm;
            padding:0.5mm;
            color:white;
            background-color:#E7342C;
            border: solid #E7342C 0.01em;
            font-size:1.2em;
        }
        .td-red-border {
            margin:0mm;
            padding:0.5mm;
            background-color:white;
            border: solid #E7342C 0.1em;
            font-size:1em;
        }
        .td-gray-back {
            margin:0mm;
            padding:0.5mm;
            background-color:#DADADA;
            color:black;
            font-size:1.2em;
        }
        .td-darkgray-back {
            margin:0mm;
            padding:0.5mm;
            color:white;
            background-color:#878787;
            text-align: center;
            font-size:1.2em;
        }
        .td-white-back-right {
            margin:0mm;
            padding:0.5mm;
            color:#4A4A4A;
            background-color:white;
            text-align: right;
            border: solid #E7342C 1px;
            font-size:1.2em;
            width:27mm;
        }
        .td-white-back-left {
            margin:0mm;
            padding:0mm;
            color:#4A4A4A;
            background-color:white;
            border-bottom: solid white 1px;
            font-size:1.1em;
        }

        .td-white-back-left2 {
            margin:0mm;
            padding:0mm;
            color:#4A4A4A;
            background-color:white;
            border-bottom: solid #E63C2E 1px;
            font-size:1.2em;
        }
        .td-unidades-center {
            text-align:center;
            padding:0.12mm;
            color:#4A4A4A;
            border-bottom: solid #878787 0.05em;
            font-size:1.2em;
            height:9.15mm;    
        }
        .td-concepto-left {
            margin:0mm;
            padding:0.12mm;
            color:#4A4A4A;
            border-bottom: solid #878787 0.05em;
            font-size:1.2em;
            height:9.15mm;    
        }
        .td-concepto-left-less-font-size {
            margin:0mm;
            padding:0.12mm;
            color:#4A4A4A;
            border-bottom: solid #878787 0.05em;
            font-size:1.0em;
            height:17mm;    
        }
        .td-concepto-right {
            margin:0mm;
            padding:0.12mm;
            color:#4A4A4A;
            border-bottom: solid #878787 0.05em;
            font-size:1.2em;
            text-align: right;
            height:9.15mm;   
        }
        .footer-red {
            padding:0.5mm;
            background-color:white;
            color:#E63C2E;
            font-size:1.5em;  
        }
        .subtotal-red {
            padding:0.5mm;
            background-color:white;
            text-align:right;
            color:#E63C2E;
            font-size:1.2em;  
        }

    </style>
</head>
<body>

    <!-- HEADER -->
    <div class="header" style="page-break-after:never">
        <div class="presupuestosub">Presupuesto&nbsp;&nbsp;</div>
        <div><img src="{!$Resource.HSAsistenciaLogoFactura}" class="logo" /></div>
    </div>

    <!-- LEFT VERTICAL TEXT -->
    <div class="vertext">
        <div><img class="vertical-text" src="{!$Resource.hs_presupuesto_left_vertical_text}" /></div>
    </div>

    <!-- FOOTER -->
    <div class="footer">
        <table style="margin:0mm; padding:0mm; border:0mm solid; width:100%" padding="0px" margin="0px">
            <tr>
                <td width="95mm" height="7mm" class="footer-red">Líderes en reparaciones del hogar</td>
                <td width="95mm" height="7mm" style="text-align:right;" class="footer-red">www.homeserve.es</td>
            </tr>
        </table>
        <div style="float:right">{!caso.CaseNumber} v.{!presupuesto.PRE_NUM_Version__c}&nbsp;</div>
        <div>&nbsp;<span class="pagenumber"/> de <span class="pagecount"/></div>
    </div>

    <!-- N. SERVICIO -->
    <div style="margin:0; padding:0mm; border:0px solid; width:100%">
        <table border="0" height="14mm" padding="0" margin="0" width="190mm">
            <tr>
                <td width="72mm">
                    <table style="margin:0mm; padding:0mm; border:0mm solid; width:100%" padding="0px" margin="0px">
                        <tr>
                            <td width="27mm" height="4mm" class="td-red-back">Fecha de Emisión</td>
                            <td width="27mm" height="4mm" class="td-white-back-right">{!fechaEmision}</td>
                        </tr>
                        <tr>
                            <td width="27mm" height="4mm" class="td-red-back">Nº de Intervención</td>
                            <td width="27mm" height="4mm" class="td-white-back-right" style="font-weight:bold;">{!caso.CaseNumber} v.{!presupuesto.PRE_NUM_Version__c}</td>
                        </tr>
                    </table>
                </td>
                <td width="138mm" style="text-align:right;font-size:10mm;color:gray"><b><strong>{!caso.CAS_LKP_Compania__r.CUE_LKP_VDN_Principal__r.VDN_TLF_Telefono__c}</strong></b></td>
           </tr>
        </table>
    </div>

    <!-- DATOS CLIENTE  mm:
                        50, 90, 12, 38
                        14, 85, 16, 75
                        19, 28, 18, 62, 15, 48
    -->

    <div style="margin:0;border:0px solid; width:190mm">
        <table border="0" padding="0" margin="0" width="190mm">
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="190mm" height="0mm" class="td-red-back">Datos Cliente</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="46mm" height="0mm" class="td-white-back-left">Nombre y Apellidos/Razón Social:</td>
                            <td width="94mm" height="0mm" class="td-white-back-left2">{!cuenta.Name}</td>
                            <td width="12mm" height="0mm" style="text-align:center;" class="td-white-back-left">CIF/NIF:</td>
                            <td width="38mm" height="0mm" class="td-white-back-left2">{!cuenta.CUE_TXT_Numero_Documento__c}</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="14mm" height="0mm" class="td-white-back-left">Dirección:</td>
                            <td width="85mm" height="0mm" class="td-white-back-left2">{!caso.CAS_TXT_Direccion__c}</td>
                            <td width="16mm" height="0mm" style="text-align:center;" class="td-white-back-left">Localidad:</td>
                            <td width="75mm" height="0mm" class="td-white-back-left2">{!caso.CAS_TXT_DirRiesgo_Poblacion__c}</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="20mm" height="0mm" class="td-white-back-left">Código Postal:</td>
                            <td width="27mm" height="0mm" class="td-white-back-left2">{!caso.CAS_TXT_DirRiesgo_CP__c}</td>
                            <td width="18mm" height="0mm" style="text-align:center;" class="td-white-back-left">Provincia:</td>
                            <td width="62mm" height="0mm" class="td-white-back-left2">{!caso.CAS_SEL_DirRiesgo_Estado_Provincia__c}</td>
                            <td width="15mm" height="0mm" style="text-align:center;" class="td-white-back-left">Teléfono:</td>
                            <td width="48mm" height="0mm" class="td-white-back-left2">{!caso.CAS_TFN_Solicitud_Telefono__c}</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
    
    <!-- DATOS INTERVENCIÓN -->

    <div style="margin:0;border:0px solid; width:190mm">
        <table border="0" padding="0" margin="0" width="190mm">
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="190mm" height="0mm" class="td-red-back">Datos Intervención</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="34mm" height="0mm" class="td-white-back-left">Nombre de la Compañía:</td>
                            <td width="61mm" height="0mm" class="td-white-back-left2">{!caso.CAS_LKP_Compania__r.Name}</td>
                            <td width="34mm" height="0mm" style="text-align:center;">Compañía de Asistencia:</td>
                            <td width="61mm" height="0mm" class="td-white-back-left2">HomeServe</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="26mm" height="0mm" class="td-white-back-left">Fecha de Apertura:</td>
                            <td width="69mm" height="0mm" class="td-white-back-left2">{!FechaAlta}</td>
                            <td width="34mm" height="0mm" style="text-align:center;">Número de Intervención:</td>
                            <td width="61mm" height="0mm" class="td-white-back-left2">{!caso.CaseNumber}</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
    
    <!-- DATOS TRAMITADOR -->

    <div style="margin:0;border:0px solid; width:190mm">
        <table border="0" padding="0" margin="0" width="190mm">
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="190mm" height="0mm" class="td-red-back">Datos Tramitador</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="33mm" height="0mm" class="td-white-back-left">Nombre del Tramitador:</td>
                            <td width="157mm" height="0mm" class="td-white-back-left2">{!caso.Owner.Name}</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td width="14mm" height="0mm" class="td-white-back-left">Teléfono:</td>
                            <td width="81mm" height="0mm" class="td-white-back-left2">{!caso.CAS_LKP_Compania__r.CUE_LKP_VDN_Principal__r.VDN_TLF_Telefono__c}</td>
                            <td width="26mm" height="0mm" style="text-align:center;">Correo electrónico:</td>
                            <td width="69mm" height="0mm" class="td-white-back-left2">{!caso.CAS_LKP_Compania__r.CUE_LKP_buzon_principal__r.BUZ_EMA_Direccion__c}</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <!-- DETALLES DE TRABAJO -->

     <div style="margin:0;border:0px solid; width:190mm">
         <table border="0" padding="0" margin="0" width="190mm">
            <tr>
                <td width="190mm" height="mm">
                     <table border="0" padding="0" margin="0" width="190mm">
                        <tr>
                            <td colspan="6" width="190mm" height="0mm" class="td-red-back">Detalle de trabajos</td>
                        </tr>
                        <tr>
                            <td width="25mm" height="0mm" class="td-gray-back">Profesión</td>
                            <td width="45mm" height="0mm" class="td-gray-back">Concepto</td>
                            <td width="60mm" height="0mm" class="td-gray-back">Observaciones</td>
                            <td width="20mm" height="0mm" class="td-gray-back">Unidades</td>
                            <td width="20mm" height="0mm" class="td-gray-back">Estado</td>
                            <td width="20mm" height="0mm" class="td-darkgray-back">Importe</td>
                        </tr>
                   </table>
                </td>
            </tr>
        </table>
    </div>

    <!-- LISTA CONCEPTOS -->
    <!-- SFDC no tiene Page: last así que tenemos que contar las lineas generadas -->
    <!-- 1ª  página: 13, o 18 si hay más de 18 lineas -->
    <!-- sig. páginas: -->

     <div style="margin:0;border:0px solid; width:188mm">
     <table border="0" padding="0" margin="0" width="188mm">
        <tr>
            <td width="188mm" height="mm">
                <table border="0" padding="0" margin="0" width="188mm">
                    <tr>
                        <td width="190mm" height="mm">
                            <table border="0" padding="0" margin="0" width="188mm">
                            <apex:repeat var="primeraPagina" value="{!lineasPrimeraPagina}">
                                <tr>
                                    <td width="25mm" class="td-concepto-left">{!primeraPagina[0]}</td>
                                    <td width="45mm" class="td-concepto-left-less-font-size">{!primeraPagina[1]}</td>
                                    <td width="60mm" class="td-concepto-left-less-font-size">{!primeraPagina[2]}</td>
                                    <td width="20mm" class="td-unidades-center">{!primeraPagina[3]}</td>
                                    <td width="20mm" class="td-concepto-left">{!primeraPagina[4]}</td> 
                                    <td width="20mm" class="td-concepto-right">{!primeraPagina[5]}</td>
                                </tr>
                            </apex:repeat>
                            <apex:repeat var="siguientesPaginas" value="{!lineasSiguientesPaginas}">
                                <apex:repeat var="sublista" value="{!siguientesPaginas}">
                                    <tr>
                                        <td width="25mm" class="td-concepto-left">{!sublista[0]}</td>
                                        <td width="45mm" class="td-concepto-left-less-font-size">{!sublista[1]}</td>
                                        <td width="60mm" class="td-concepto-left-less-font-size">{!sublista[2]}</td>
                                        <td width="20mm" class="td-unidades-center">{!sublista[3]}</td>
                                        <td width="20mm" class="td-concepto-left">{!sublista[4]}</td>
                                        <td width="20mm" class="td-concepto-right">{!sublista[5]}</td>
                                    </tr>
                                </apex:repeat>
                            </apex:repeat>   
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    </div>

    <div class="">
         <div style="margin:0;border:0; width:190mm;">
            <table border="0" padding="0" margin="0" width="190mm">
                <tr>
                    <td width="60mm" height="27mm">
                        <table border="0" padding="0" margin="0" width="60mm">
                            <tr>
                                <td width="60mm" height="5mm" class="td-red-back">Autorización {!if(tipoDestino == $Label.TIPO_CONTACTO_DEST_CLIENTE, 'del Cliente', 'de la Compañía')}</td>
                            </tr>
                            <tr>
                                <td width="60mm" height="22mm" valign="top" class="td-red-border"><small>PRESUPUESTO RECIBIDO ANTES DE REALIZACIÓN DEL TRABAJO</small></td>
                            </tr>
                        </table>
                    </td>
                    <td width="60mm" height="27mm">
                        <table border="0" padding="0" margin="0" width="60mm">
                            <tr>
                                <td width="60mm" height="5mm" class="td-red-back">Firma del profesional - Nº</td>
                            </tr>
                            <tr>
                                <td width="60mm" height="22mm" class="td-red-border"></td>
                            </tr>
                        </table>
                    </td>
                    <td width="70mm" height="27mm">
                         <table border="0" padding="0" margin="0" width="66mm">
                            <tr>
                                <td width="46mm" class="subtotal-red">Base Imponible</td>
                                <td width="20mm" class="td-white-back-right">{!baseImponible} €</td>
                            </tr>
                            <tr>
                                <td width="46mm" class="subtotal-red">I.V.A.</td>
                                <td width="20mm" class="td-white-back-right">{!impuesto}</td>
                            </tr>
                        </table>
                        <br/>
                       <table border="0" padding="0" margin="0" width="66mm">
                            <tr>
                                <td class="subtotal-red" style="font-size:1.8em">Importe Total</td>
                                <td class="td-white-back-right" style="font-size:1.8em">{!importeTotal} €</td>
                            </tr>
                        </table>

                    </td>
                </tr>
                <tr>
                    <td colspan="3" style="background-color:#E3E3E3;font-size:0.8em;padding-top:0.3em;padding-bottom:0.3em;">
                        <ul style="position:relative;left:-6mm;margin-top:0em;margin-bottom:0em">
                            <li>Todos los trabajos tienen una garantía de 1 año.</li>
                            <li>Este presupuesto tiene una validez de 30 días desde su fecha de emisión.</li>
                            <li>Se podrá solicitar un 50% como anticipo.</li>
                            <li>HOMESERVE ASISTENCIA SPAIN, S.A.U. dispone de un seguro de Responsabilidad Civil.</li>
                            <li>HOMESERVE ASISTENCIA SPAIN, S.A.U. declina toda responsabilidad por las incidencias que puedan surgir en los siguientes casos:
                                <ul style="position:relative;left:-6mm;">
                                    <li>Que se haya informado previamente al cliente de algún posible riesgo y haya dado su conformidad.</li>
                                    <li>Que el incidente se produzca como consecuencia de defectos ocultos en la construcción de origen.</li>
                                    <li>Que exista negligencia por parte del cliente.</li>
                                </ul>
                            </li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td colspan="3" style="font-size:0.7em">Los datos personales que constan en este documento, serán incorporados al fichero de “clientes” de HOMESERVE ASISTENCIA SPAIN, S.A.U., con la finalidad de gestionar la prestación del servicio ofrecido por HOMESERVE ASISTENCIA SPAIN, S.A.U., por lo
que dichos datos no serán comunicados ni cedidos a terceros sin su expreso consentimiento. De conformidad con lo dispuesto en la Ley Orgánica 15/1999, de Protección de Datos, así como en su Reglamento de desarrollo, le informamos que puede ejercer
los derechos de acceso, rectificación, cancelación y oposición dirigiéndose por escrito, a HOMESERVE ASISTENCIA SPAIN, S.A.U., Camino del Cerro de los Gamos, 1, Edificio 6. 28.224- Pozuelo de Alarcón (Madrid).<br />
<big>[&nbsp;&nbsp;&nbsp;]</big> Le informamos que sus datos podrán ser cedidos a HOMESERVE SPAIN S.L.U. para fines de prospección comercial. En el caso en que Vd. no consienta el tratamiento de sus datos según lo expuesto, debe marcar la casilla situada a la izquierda.</td>
                </tr>
            </table>
        </div>
    </div>
   

</body>
</apex:page>